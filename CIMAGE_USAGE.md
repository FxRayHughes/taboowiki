# CImage 全局组件使用说明

## 已创建的文件

1. **组件文件**: `src/components/CImage/index.jsx`
2. **样式文件**: `src/components/CImage/styles.css`
3. **MDX 组件注册**: `src/theme/MDXComponents.js`

## ✨ 新功能：图片预览模态框

双击图片后会打开一个全屏预览模态框，支持以下功能：

### 📸 预览功能

- ✅ **双击打开预览**：双击任意 `<CImage>` 组件查看大图
- ✅ **放大/缩小**：点击按钮或使用键盘快捷键
- ✅ **缩放范围**：0.5 倍 ~ 3 倍（每次增减 25%）
- ✅ **实时显示缩放比例**：按钮上显示当前缩放百分比
- ✅ **关闭预览**：点击背景、关闭按钮或按 ESC 键
- ✅ **图片说明**：底部显示图片描述文字

### ⌨️ 键盘快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `ESC` | 关闭预览 | 退出全屏模态框 |
| `Ctrl/Cmd + +` | 放大 | 放大 25%（最大 300%）|
| `Ctrl/Cmd + -` | 缩小 | 缩小 25%（最小 50%）|
| `Ctrl/Cmd + 0` | 重置缩放 | 恢复到 100% |
| `双击图片` | 打开预览 | 查看大图 |
| `点击背景` | 关闭预览 | 点击黑色背景区域关闭 |

### 🎨 界面特性

- **全屏黑色背景**：沉浸式查看体验
- **毛玻璃效果**：控制按钮和说明文字背景
- **平滑动画**：缩放和显示动画流畅自然
- **响应式设计**：自适应不同屏幕尺寸
- **暗色主题适配**：自动适配 Docusaurus 主题
- **禁用状态提示**：达到最大/最小缩放时按钮变灰

## 重启开发服务器

**重要！** 添加新的 theme 组件后，必须重启 Docusaurus 开发服务器才能生效。

### 步骤：

1. 停止当前的开发服务器（Ctrl+C）
2. 重新启动：
   ```bash
   npm run start
   # 或
   yarn start
   ```

## 使用方法

在任何 `.md` 或 `.mdx` 文件中，直接使用 `<CImage>` 组件，无需导入：

### 基础用法

```mdx
<CImage id="8483B4C09F4B31698CFDD96A15A21964" alt="构建刷新" />
```

### 带标题

```mdx
<CImage id="2F30EAE3E2A2A435DC62BE19A6D7A05F" alt="插件市场" title="自定义标题文字" />
```

### 自定义缩略图尺寸

```mdx
<CImage id="8483B4C09F4B31698CFDD96A15A21964" alt="构建刷新" zoom="80%" />
```

## 组件参数

| 参数 | 类型 | 必需 | 默认值 | 说明 |
|------|------|------|--------|------|
| `id` | string | ✅ 是 | - | 图片 ID（不含 .png 后缀） |
| `alt` | string | 否 | `"图片"` | 图片替代文本（也会显示在预览模态框底部） |
| `title` | string | 否 | 使用 `alt` | 鼠标悬停时显示的标题 |
| `zoom` | string | 否 | `"100%"` | 缩略图最大宽度（如 `"80%"`、`"500px"`） |

## 示例对比

### 旧方式（繁琐）
```mdx
![构建刷新](https://openlist.maplex.top/p/image/8483B4C09F4B31698CFDD96A15A21964.png "构建刷新")
```

### 新方式（简洁）
```mdx
<CImage id="8483B4C09F4B31698CFDD96A15A21964" alt="构建刷新" />
```

**优势：**
- 节省约 42% 的代码量
- 自动图片预览功能
- 键盘快捷键支持
- 更好的用户体验

## 组件特性

### 缩略图

- ✅ 自动拼接图片 URL
- ✅ 响应式设计（maxWidth: 100%）
- ✅ 懒加载（loading="lazy"）
- ✅ 圆角和阴影样式
- ✅ 悬停放大效果
- ✅ 鼠标悬停提示（双击查看大图）

### 预览模态框

- ✅ 全屏显示
- ✅ 放大/缩小控制（0.5x ~ 3x）
- ✅ 键盘快捷键支持
- ✅ 点击背景关闭
- ✅ ESC 键关闭
- ✅ 图片说明显示
- ✅ 实时缩放比例显示
- ✅ 按钮禁用状态
- ✅ 毛玻璃效果
- ✅ 平滑动画
- ✅ 响应式设计

## 使用场景

### 1. 教程文档

```mdx
### 步骤 1：安装插件

<CImage id="2F30EAE3E2A2A435DC62BE19A6D7A05F" alt="插件市场搜索界面" />

在插件市场中搜索 "Taboo Development"...
```

### 2. 配置说明

```mdx
### 配置项目

<CImage id="f01aa769-55c8-4b29-8f4c-ed902f8790ef" alt="项目配置界面" />

填写以下配置信息...
```

### 3. 自定义缩略图大小

```mdx
<!-- 小尺寸显示 -->
<CImage id="xxx" alt="小图" zoom="60%" />

<!-- 大尺寸显示 -->
<CImage id="xxx" alt="大图" zoom="100%" />
```

## 故障排查

如果组件不生效，检查：

1. ✅ 是否重启了开发服务器
2. ✅ 文件路径是否正确
3. ✅ 组件名称是否大写开头（`<CImage>` 而不是 `<cimage>`）
4. ✅ 图片 ID 是否正确
5. ✅ 是否有 JavaScript 错误（查看浏览器控制台）

### 常见错误

**错误 1：组件未定义**
```
Expected component `CImage` to be defined
```

**解决方法**：重启开发服务器

**错误 2：图片无法加载**
```
Failed to load image
```

**解决方法**：检查图片 ID 是否正确

## 浏览器兼容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+
- ✅ 移动端浏览器

## 性能优化

- ✅ **懒加载**：图片使用 `loading="lazy"` 属性
- ✅ **按需渲染**：模态框仅在打开时渲染
- ✅ **事件清理**：组件卸载时自动清理事件监听
- ✅ **防止滚动**：模态框打开时禁止页面滚动

## 已更新的文档

已在以下文档中使用了 `<CImage>` 组件：
- `docs/start-hand/taboo-plugin/index.mdx`（8 张图片）

## 更新日志

### v2.0.0 (2025-01-03)

- ✨ 新增图片预览模态框功能
- ✨ 新增放大/缩小控制
- ✨ 新增键盘快捷键支持
- ✨ 新增实时缩放比例显示
- ✨ 新增按钮禁用状态
- ✨ 新增图片说明显示
- ✨ 新增点击背景关闭
- 🎨 优化 UI 设计（毛玻璃效果）
- 🎨 优化动画效果
- 📱 优化响应式设计
- 🌙 优化暗色主题适配

### v1.0.0 (2025-01-03)

- ✨ 初始版本
- ✨ 基础图片显示功能
- ✨ 自动拼接 URL
- ✨ 懒加载支持

---

**维护者：** TabooLib Development Team
**最后更新：** 2025-01-03
